wqp_clean_fns <- list(
  
  tar_target(wqp_invalid_units, c("CONDUCTIVITY_NA_NA_%", "DISSOLVED OXYGEN (DO)_NA_NA_%", "PH_NA_NA_%", "TEMPERATURE_NA_NA_%", "TURBIDITY_NA_NA_%", "DISSOLVED OXYGEN (DO)_NA_NA_UG/KG",
                                "PH_NA_NA_MMOL/L", "STREAM FLOW_NA_NA_M/SEC", "TURBIDITY_NA_NA_IN", "TURBIDITY_NA_NA_NA", "TOTAL DISSOLVED SOLIDS_FILTERED_NA_LB/DAY",
                                "CHLOROPHYLL A_UNFILTERED_NA_G/M2", "STREAM FLOW_NA_NA_LB/DAY", "TOTAL SUSPENDED SOLIDS_NON-FILTERABLE (PARTICLE)_NA_%", "SILICA_DISSOLVED_AS SIO2_MG/L", "SILICA_DISSOLVED_AS SI_MG/L")), #dropping two silica types that won't harmonize - 16 measurements total
  
  tar_target(wqp_fix_values, Vectorize(function(name, unit, val) {
    if (is.na(unit)) return(val)
    else if (unit == "IN") return(val*2.54)
    else if (name %in% c("CHLOROPHYLL A", "PHEOPHYTIN A")) return(val)
    else if (unit == "UG/L" | unit == "UG/KG") return(val*0.001)
    else return(val)
  })),
  
  tar_target(wqp_fix_units, Vectorize(function(name, unit) {
    if (is.na(unit)) return(unit)
    else if (name %in% c("CHLOROPHYLL A", "PHEOPHYTIN A")) return(unit)
    else if (unit == "MG N/L******") return ("MG/L")
    else if (unit == "% SATURATN") return ("%")
    else if (unit == "STD UNITS") return ("NA")
    else if (unit == "US/CM @25C") return ("US/CM")
    else if (unit == "UG/L" | unit == "UG/KG") return ("MG/L")
    else return(unit)
  })),
  
  tar_target(renameMonitType, Vectorize(function (name, id) {
    gl_rename <- c("MNPCA-16-0001-00-239", "MNPCA-16-0001-00-258", "MNPCA-16-0001-00-259", "MNPCA-16-0001-00-240", "MNPCA-16-0001-00-241",
                   "MNPCA-S003-989", "MNPCA-S001-268", "MNPCA-S003-978", "MNPCA-S003-986", "WIDNR_WQX-10019105", "WIDNR_WQX-10038138", 
                   "REDCLIFF_WQX-SRM01", "REDCLIFF_WQX-RRM01", "REDCLIFF_WQX-FCM01", "REDCLIFF_WQX-RCCM01", "WIDNR_WQX-043099", 
                   "BADRIVER_WQX-KakLakeSup", "BADRIVER_WQX-BellMouth", "USGS-04027675", "BADRIVER_WQX-BadMouth", "USGS-04027655",
                   "USGS-464643092053701", "USGS-464222092010201", "USGS-464048091563501", "USGS-465135091061401", "USGS-465133091060301",
                   "USGS-465130091060701", "USGS-465142090311901", "USGS-464449090310901", "USGS-464742090480701", "USGS-464413090465901",
                   "USGS-464200090432301", "USGS-464158090472101", "USGS-463905090460701", "USGS-463927090384501", "USGS-463859090385701",
                   "USGS-463844090390401", "USGS-463834090390301", "USGS-463812090375101", "USGS-463800090370701", "WIDNR_WQX-10019598", "USGS-464226092005600")
    es_rename <- c("MNPCA-09-0167-00-100", "MNPCA-16-0001-00-242", "USGS-463914092124701", "MNPCA-69-1291-00-254", "USGS-464107092094201",
                   "USGS-464217092085301", "USGS-464230092083201", "USGS-464444092070401", "MNPCA-69-1291-02-201", "USGS-464433092050601",
                   "USGS-464348092040901", "USGS-464313092031101", "USGS-464131092001201", "NARS_WQX-NGL_MN-10014", "NARS_WQX-NGL_MN-10012",
                   "NARS_WQX-NGL_MN-10011", "NARS_WQX-NGL_MN-10017", "NARS_WQX-NGL_MN-10019", "NARS_WQX-NGL_MN-10015", "NARS_WQX-NCCAGL10-2001",
                   "NARS_WQX-NCCAGL10-GLBA10-134", "NARS_WQX-NCCAGL10-GLBA10-118", "NARS_WQX-NCCAGL10-GLBA10-038", "NARS_WQX-NCCAGL10-GLBA10-054",
                   "MNPCA-16-0001-00-B007", "MNPCA-16-0001-00-B037", "MNPCA-16-0001-00-B004", "21WIBCH-0313B110", "MNPCA-16-0001-00-B002", "MNPCA-16-0001-00-B001",
                   "WIDNR_WQX-10048289", "WIDNR_WQX-10048290", "WIDNR_WQX-10048291", "WIDNR_WQX-10048784", "WIDNR_WQX-10048785", "WIDNR_WQX-10048292",
                   "WIDNR_WQX-10048783", "WIDNR_WQX-10041152", "WIDNR_WQX-10034508", "WIDNR_WQX-10041156", "WIDNR_WQX-10041155", "WIDNR_WQX-10041153",
                   "WIDNR_WQX-10014688", "WIDNR_WQX-10034506", "WIDNR_WQX-10034507", "WIDNR_WQX-10052531", "WIDNR_WQX-10034505", "WIDNR_WQX-10014687",
                   "WIDNR_WQX-10041154", "WIDNR_WQX-10038054", "WIDNR_WQX-10012690", "WIDNR_WQX-10034504", "WIDNR_WQX-10038055", "WIDNR_WQX-10014686",
                   "WIDNR_WQX-10031417", "WIDNR_WQX-10028979", "WIDNR_WQX-10048278", "WIDNR_WQX-10034502", "WIDNR_WQX-10048284", "WIDNR_WQX-10048281",
                   "WIDNR_WQX-10037323", "WIDNR_WQX-10037322", "WIDNR_WQX-10037321", "WIDNR_WQX-10029156", "MNPCA_BIO-S004-971", "MNPCA-S004-971", "21WIBCH-0313B64",
                   "MNPCA-S000-021", "USGS-04024025", "MNPCA-S004-976", "USGS-463913092162401", "USGS-04024026", "WIDNR_WQX-10037338", "WIDNR_WQX-10037337",
                   "WIDNR_WQX-10037336", "WIDNR_WQX-10037334", "WIDNR_WQX-10014692", "WIDNR_WQX-10037330", "WIDNR_WQX-10037331", "WIDNR_WQX-10037332",
                   "WIDNR_WQX-10037333", "USGS-0402402850", "WIDNR_WQX-10034500", "WIDNR_WQX-163001", "MNPCA-S000-262", "USGS-463925092120601", "WIDNR_WQX-10037320",
                   "WIDNR_WQX-10014691", "WIDNR_WQX-10034501", "FONDULAC_WQX-SLRSIU", "FONDULAC_WQX-SLRSID", "USGS-0402403450", "USGS-464145092105401",
                   "WIDNR_WQX-10037329", "WIDNR_WQX-10037328", "WIDNR_WQX-10037326", "WIDNR_WQX-10037325", "WIDNR_WQX-10014690", "WIDNR_WQX-10028981",
                   "WIDNR_WQX-10034503", "MNPCA-S000-639", "WIDNR_WQX-10034499", "USGS-464227092092701", "WIDNR_WQX-10014689", "USGS-464326092084101",
                   "USGS-464348092091401", "USGS-464349092083701", "USGS-464414092090201", "USGS-464419092085301", "USGS-464502092080401", "USGS-464459092072503",
                   "USGS-464459092072501", "USGS-464506092065601", "USGS-464507092065802", "USGS-464508092064402", "USGS-464513092063603", "USGS-464509092070903",
                   "USGS-464517092071802", "USGS-464514092070003", "USGS-464516092065303", "USGS-464516092064503", "USGS-464519092065603", "USGS-464520092065003",
                   "USGS-464521092065403", "USGS-464521092070802", "USGS-464521092070202", "USGS-464523092064703", "USGS-464524092070302", "USGS-464524092070303",
                   "USGS-464525092064703", "USGS-464526092072002", "USGS-464527092070102", "USGS-464527092070103", "USGS-464528092070401", "USGS-464528092065903",
                   "USGS-464528092065002", "USGS-464529092065602", "USGS-464529092065402", "USGS-464529092065403", "USGS-464529092070402", "USGS-464531092070502",
                   "USGS-464531092064901", "USGS-464532092070203", "USGS-464532092070602", "USGS-464532092065402", "USGS-464532092071201", "USGS-464532092071102",
                   "USGS-464533092070203", "USGS-464533092070103", "USGS-464534092070103", "USGS-464533092065702", "USGS-464534092065402", "USGS-464534092065301",
                   "USGS-464535092070702", "USGS-464534092071501", "USGS-464534092071502", "USGS-464538092070603", "USGS-464537092071502", "USGS-464538092070902",
                   "USGS-464538092070903", "USGS-464542092070902", "USGS-464543092070601", "USGS-464543092071401", "USGS-464545092070601", "USGS-464545092070602",
                   "USGS-464546092071301", "USGS-464546092071302", "USGS-464546092071303", "USGS-464548092071001", "USGS-464548092071002", "USGS-464504092063401",
                   "USGS-464503092061803", "MNPCA-S003-975", "MNPCA-S000-277", "USGS-464655092054801", "USGS-464626092062201", "USGS-464633092053801", "USGS-464629092053801",
                   "USGS-464610092053301", "USGS-464611092052601", "USGS-464453092050301", "USGS-464503092042301", "USGS-464434092042201", "USGS-464425092035701",
                   "USGS-464420092034301", "USGS-464303092022301", "USGS-464258092022001", "USGS-463849092131601", "USGS-463959092114401", "USGS-464209092120001",
                   "USGS-464503092061802", "USGS-464459092072502", "USGS-464503092061801", "USGS-464513092063602", "USGS-464508092064401", "USGS-464507092065801",
                   "USGS-464509092070902", "USGS-464513092063602", "USGS-464516092064502", "USGS-464516092065302", "USGS-464514092070002", "USGS-464517092071801",
                   "USGS-464526092072001", "USGS-464521092070801", "USGS-464509092070901", "USGS-464514092070001", "USGS-464516092065301", "USGS-464516092064501",
                   "USGS-464513092063601", "USGS-464519092065602", "USGS-464521092065402", "USGS-464520092065002", "USGS-464523092064702", "USGS-464525092064702",
                   "USGS-464528092065001", "USGS-464529092065401", "USGS-464529092065601", "USGS-464528092065902", "USGS-464527092070101", "USGS-464524092070301",
                   "USGS-464521092070201", "USGS-464532092071101", "USGS-464537092071501", "USGS-464542092070901", "USGS-464538092070901", "USGS-464538092070602",
                   "USGS-464535092070701", "USGS-464519092065601", "USGS-464521092065401", "USGS-464520092065001", "USGS-464523092064701", "USGS-464525092064701",
                   "USGS-464528092065901", "USGS-464538092070601", "USGS-464529092070401", "USGS-464531092070501", "USGS-464532092070601", "USGS-464532092070202",
                   "USGS-464533092070202", "USGS-464533092070102", "USGS-464534092070102", "USGS-464533092065701", "USGS-464534092065401", "USGS-464532092065401",
                   "USGS-464532092070201", "USGS-464532092070201", "USGS-464533092070101", "USGS-464534092070101", "USGS-464533092070201", "USGS-464643092053701")
    
    str_rename <- c("WIDNR_WQX-10048632", "USGS-040260078")
    wet_rename <- c("WIDNR_WQX-10048913", "WIDNR_WQX-10048916", "WIDNR_WQX-10048882", "WIDNR_WQX-10048911", "WIDNR_WQX-10048912")
    
    if (id %in% gl_rename) return("Great Lake")
    else if (id %in% es_rename) return("Estuary")
    else if (id %in% str_rename) return("River/Stream")
    else if (id %in% wet_rename) return("Wetland")
    else if (name == "BEACH Program Site-Great Lake") return("Great Lake")
    else if (name == "Stream") return("River/Stream")
    else if (name == "Lake, Reservoir, Impoundment") return("Lake")
    else return(name)
  })),
  
  
  tar_target(wqp_drop_cols, function(wqp){
    na_cols <- c()
    uno_cols <- c()
    uno_vals <- c()
    duo_cols <- c()
    
    for (n in 1:length(wqp)) {
      cur_name <- colnames(wqp)[n]
      cur_vals <- unique(unlist(wqp[n]))
      if (length(cur_vals) <= 2) {
        if (all(is.na(cur_vals))) na_cols <- append(na_cols, cur_name)
        else if (any(is.na(cur_vals)) | length(cur_vals) == 1) {
          uno_cols <- append(uno_cols, cur_name)
          uno_vals <- append(uno_vals, cur_vals[!is.na(cur_vals)])
        }
        else duo_cols <- append(duo_cols, cur_name)
      }
    }
    
    # currently just returning na cols as needing to drop
    return(na_cols)
  })
  
)